{"version":3,"file":"shady-render-scoping-shim_test.js","sourceRoot":"","sources":["../../../src/test/lib/shady-render-scoping-shim_test.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\nimport {html} from '../../lib/shady-render.js';\nimport {policy} from '../test-utils/security.js';\nimport {renderShadowRoot} from '../test-utils/shadow-root.js';\n\nconst assert = chai.assert;\n\nsuite('shady-render scoping shim', () => {\n  setup(function() {\n    if (typeof window.ShadyDOM === 'undefined' || !window.ShadyDOM.inUse ||\n        typeof window.ShadyCSS === 'undefined' ||\n        window.ShadyCSS.nativeShadow ||\n        window.ShadyCSS.ScopingShim === undefined) {\n      this.skip();\n      return;\n    }\n  });\n\n  let testName;\n\n  testName = 'scoped styles are applied for non-TemplateResult values';\n  test(testName, function() {\n    const container = document.createElement('scope-1');\n    window.ShadyCSS!.ScopingShim!.prepareAdoptedCssText(\n        [':host { border-top: 2px solid black; }'], 'scope-1');\n    document.body.appendChild(container);\n    renderShadowRoot(undefined, container);\n    assert.equal(\n        getComputedStyle(container).getPropertyValue('border-top-width').trim(),\n        '2px');\n    document.body.removeChild(container);\n  });\n\n  testName = 'adopted CSS remains when rendering a TemplateResult after an ' +\n      'initial non-TemplateResult';\n  test(testName, function() {\n    const container = document.createElement('scope-2');\n    window.ShadyCSS!.ScopingShim!.prepareAdoptedCssText(\n        [':host { border-top: 2px solid black; } button { font-size: 7px; } '],\n        'scope-2');\n    document.body.appendChild(container);\n    renderShadowRoot(undefined, container);\n    assert.equal(\n        getComputedStyle(container).getPropertyValue('border-top-width').trim(),\n        '2px');\n    renderShadowRoot(html`<button>This is a button.</button>`, container);\n    assert.equal(\n        getComputedStyle(container).getPropertyValue('border-top-width').trim(),\n        '2px');\n    assert.equal(\n        getComputedStyle(container.shadowRoot!.querySelector('button')!)\n            .getPropertyValue('font-size')\n            .trim(),\n        '7px');\n    document.body.removeChild(container);\n  });\n\n  testName = 'Styles inserted in the initial render through NodeParts are ' +\n      'scoped.';\n  test(testName, function() {\n    const style = document.createElement('style');\n    style.innerHTML = policy.createHTML(\n        ':host { border-top: 2px solid black; } button { font-size: 7px; }');\n    const container = document.createElement('scope-3');\n    document.body.appendChild(container);\n    renderShadowRoot(\n        html`${style}<button>This is a button.</button>`, container);\n    assert.equal(\n        getComputedStyle(container).getPropertyValue('border-top-width').trim(),\n        '2px');\n    assert.equal(\n        getComputedStyle(container.shadowRoot!.querySelector('button')!)\n            .getPropertyValue('font-size')\n            .trim(),\n        '7px');\n    document.body.removeChild(container);\n  });\n});\n"]}